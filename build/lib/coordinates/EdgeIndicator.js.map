{"version":3,"sources":["../../../src/lib/coordinates/EdgeIndicator.js"],"names":["EdgeIndicator","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","edge","helper","getAxisCanvas","Component","propTypes","yAccessor","PropTypes","func","type","oneOf","className","string","fill","oneOfType","lineStroke","textFill","itemType","isRequired","orient","edgeAt","displayFormat","rectHeight","number","rectWidth","arrowWidth","lineStrokeDasharray","strokeDashTypes","defaultProps","yAxisPad","fontFamily","fontSize","dx","hideLine","opacity","stroke","noop","strokeOpacity","strokeWidth","lineOpacity","plotData","item","getEdge","edgeType","xScale","yScale","chartConfig","xAccessor","width","yValue","xValue","x1","Math","round","y1","left","right","edgeX","coordinate","show","x2","y2"],"mappings":"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","file":"EdgeIndicator.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { format } from \"d3-format\";\r\n\r\nimport { drawOnCanvas, renderSVG } from \"./EdgeCoordinateV3\";\r\nimport GenericChartComponent from \"../GenericChartComponent\";\r\nimport { getAxisCanvas } from \"../GenericComponent\";\r\n\r\nimport { first, last, isDefined, functor, noop, strokeDashTypes } from \"../utils\";\r\n\r\nclass EdgeIndicator extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst edge = helper(this.props, moreProps);\r\n\t\tconst props = {\r\n\t\t\t...this.props,\r\n\t\t\t...edge,\r\n\t\t};\r\n\t\tdrawOnCanvas(ctx, props);\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst edge = helper(this.props, moreProps);\r\n\t\tconst props = {\r\n\t\t\t...this.props,\r\n\t\t\t...edge,\r\n\t\t};\r\n\t\treturn renderSVG(props);\r\n\t}\r\n\trender() {\r\n\t\treturn <GenericChartComponent\r\n\t\t\tedgeClip\r\n\t\t\tclip={false}\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\tcanvasToDraw={getAxisCanvas}\r\n\t\t\tdrawOn={[\"pan\"]}\r\n\t\t/>;\r\n\t}\r\n}\r\n\r\nEdgeIndicator.propTypes = {\r\n\tyAccessor: PropTypes.func,\r\n\r\n\ttype: PropTypes.oneOf([\"horizontal\"]),\r\n\tclassName: PropTypes.string,\r\n\tfill: PropTypes.oneOfType([\r\n\t\tPropTypes.string,\r\n\t\tPropTypes.func,\r\n\t]),\r\n\tlineStroke: PropTypes.oneOfType([\r\n\t\tPropTypes.string,\r\n\t\tPropTypes.func,\r\n\t]),\r\n\ttextFill: PropTypes.oneOfType([\r\n\t\tPropTypes.string,\r\n\t\tPropTypes.func,\r\n\t]),\r\n\titemType: PropTypes.oneOf([\"first\", \"last\"]).isRequired,\r\n\torient: PropTypes.oneOf([\"left\", \"right\"]),\r\n\tedgeAt: PropTypes.oneOf([\"left\", \"right\"]),\r\n\tdisplayFormat: PropTypes.func,\r\n\trectHeight: PropTypes.number,\r\n\trectWidth: PropTypes.number,\r\n\tarrowWidth: PropTypes.number,\r\n\tlineStrokeDasharray: PropTypes.oneOf(strokeDashTypes),\r\n};\r\n\r\nEdgeIndicator.defaultProps = {\r\n\tclassName: \"react-stockcharts-edgeindicator\",\r\n\r\n\ttype: \"horizontal\",\r\n\torient: \"left\",\r\n\tedgeAt: \"left\",\r\n\ttextFill: \"#FFFFFF\",\r\n\tdisplayFormat: format(\".2f\"),\r\n\tyAxisPad: 0,\r\n\trectHeight: 20,\r\n\trectWidth: 50,\r\n\tarrowWidth: 10,\r\n\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\r\n\tfontSize: 13,\r\n\tdx: 0,\r\n\thideLine: false,\r\n\tfill: \"#8a8a8a\",\r\n\topacity: 1,\r\n\r\n\tstroke: noop,\r\n\tstrokeOpacity: 1,\r\n\tstrokeWidth: 3,\r\n\tlineStroke: \"#000000\",\r\n\tlineOpacity: 0.3,\r\n\tlineStrokeDasharray: \"ShortDash\",\r\n};\r\n\r\nfunction helper(props, moreProps) {\r\n\tconst { itemType, yAccessor } = props;\r\n\tconst { plotData } = moreProps;\r\n\r\n\tconst item = itemType === \"first\"\r\n\t\t? first(plotData, yAccessor)\r\n\t\t: last(plotData, yAccessor);\r\n\r\n\t// var currentItem = ChartDataUtil.getCurrentItemForChartNew(currentItems, forChart);\r\n\tconst edge = isDefined(item)\r\n\t\t? getEdge(props, moreProps, item)\r\n\t\t: null;\r\n\r\n\treturn edge;\r\n}\r\n\r\nfunction getEdge(props, moreProps, item) {\r\n\tconst { type: edgeType, displayFormat, edgeAt, yAxisPad, orient, lineStroke } = props;\r\n\r\n\tconst { yAccessor, fill, textFill, rectHeight, rectWidth, arrowWidth } = props;\r\n\tconst { fontFamily, fontSize } = props;\r\n\tconst { stroke } = props;\r\n\r\n\tconst { xScale, chartConfig: { yScale }, xAccessor, width } = moreProps;\r\n\r\n\tconst yValue = yAccessor(item),\r\n\t\txValue = xAccessor(item);\r\n\r\n\tconst x1 = Math.round(xScale(xValue)),\r\n\t\ty1 = Math.round(yScale(yValue));\r\n\r\n\tconst [left, right] = [0, width];\r\n\tconst edgeX = edgeAt === \"left\"\r\n\t\t? left - yAxisPad\r\n\t\t: right + yAxisPad;\r\n\r\n\treturn {\r\n\t\t// ...props,\r\n\t\tcoordinate: displayFormat(yValue),\r\n\t\tshow: true,\r\n\t\ttype: edgeType,\r\n\t\torient,\r\n\t\tedgeAt: edgeX,\r\n\t\tfill: functor(fill)(item),\r\n\t\tlineStroke: functor(lineStroke)(item),\r\n\t\tstroke: functor(stroke)(item),\r\n\t\tfontFamily, fontSize,\r\n\t\ttextFill: functor(textFill)(item),\r\n\t\trectHeight, rectWidth, arrowWidth,\r\n\t\tx1,\r\n\t\ty1,\r\n\t\tx2: right,\r\n\t\ty2: y1,\r\n\t};\r\n}\r\n\r\nexport default EdgeIndicator;\r\n"]}