{"version":3,"sources":["../../../src/lib/annotation/Label.js"],"names":["Label","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","drawOnCanvas2","context","selectCanvas","chartConfig","getYScale","getText","Component","text","Array","isArray","undefined","yScale","propTypes","className","PropTypes","string","func","oneOfType","isRequired","textAnchor","fontFamily","fontSize","number","opacity","rotate","onClick","xAccessor","xScale","datum","object","x","y","contextTypes","canvasOriginX","canvasOriginY","margin","ratio","defaultProps","canvases","bg","save","setTransform","scale","translate","left","top","restore","xPos","yPos","fill","radians","Math","PI","font","fillStyle","textAlign","beginPath","fillText"],"mappings":"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","file":"Label.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport GenericComponent from \"../GenericComponent\";\r\n\r\nimport { isDefined, hexToRGBA, functor } from \"../utils\";\r\nimport LabelAnnotation, { defaultProps, helper } from \"./LabelAnnotation\";\r\n\r\nclass Label extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tdrawOnCanvas2(ctx, this.props, this.context, moreProps);\r\n\t}\r\n\trender() {\r\n\t\treturn <GenericComponent\r\n\t\t\tcanvasToDraw={this.props.selectCanvas}\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\tdrawOn={[]}\r\n\t\t/>;\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { chartConfig } = moreProps;\r\n\r\n\t\treturn <LabelAnnotation yScale={getYScale(chartConfig)} {...this.props} text={getText(this.props)}/>;\r\n\t}\r\n}\r\n\r\nfunction getText(props) {\r\n\treturn functor(props.text)(props);\r\n}\r\n\r\nfunction getYScale(chartConfig) {\r\n\treturn Array.isArray(chartConfig) ? undefined : chartConfig.yScale;\r\n}\r\n\r\nLabel.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tselectCanvas: PropTypes.func,\r\n\ttext: PropTypes.oneOfType([\r\n\t\tPropTypes.string,\r\n\t\tPropTypes.func\r\n\t]).isRequired,\r\n\ttextAnchor: PropTypes.string,\r\n\tfontFamily: PropTypes.string,\r\n\tfontSize: PropTypes.number,\r\n\topacity: PropTypes.number,\r\n\trotate: PropTypes.number,\r\n\tonClick: PropTypes.func,\r\n\txAccessor: PropTypes.func,\r\n\txScale: PropTypes.func,\r\n\tyScale: PropTypes.func,\r\n\tdatum: PropTypes.object,\r\n\tx: PropTypes.oneOfType([\r\n\t\tPropTypes.number,\r\n\t\tPropTypes.func\r\n\t]),\r\n\ty: PropTypes.oneOfType([\r\n\t\tPropTypes.number,\r\n\t\tPropTypes.func\r\n\t])\r\n};\r\n\r\nLabel.contextTypes = {\r\n\tcanvasOriginX: PropTypes.number,\r\n\tcanvasOriginY: PropTypes.number,\r\n\r\n\tmargin: PropTypes.object.isRequired,\r\n\tratio: PropTypes.number.isRequired,\r\n};\r\n\r\nLabel.defaultProps = {\r\n\t...defaultProps,\r\n\tselectCanvas: canvases => canvases.bg,\r\n};\r\n\r\nfunction drawOnCanvas2(ctx, props, context, moreProps) {\r\n\tctx.save();\r\n\r\n\tconst { canvasOriginX, canvasOriginY, margin, ratio } = context;\r\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\tctx.scale(ratio, ratio);\r\n\r\n\r\n\tif (isDefined(canvasOriginX))\r\n\t\tctx.translate(canvasOriginX, canvasOriginY);\r\n\telse\r\n\t\tctx.translate(margin.left + (0.5 * ratio), margin.top + (0.5 * ratio));\r\n\r\n\tdrawOnCanvas(ctx, props, moreProps);\r\n\r\n\tctx.restore();\r\n\r\n}\r\n\r\nfunction drawOnCanvas(ctx, props, moreProps) {\r\n\tconst { textAnchor, fontFamily, fontSize, opacity, rotate } = props;\r\n\tconst { xScale, chartConfig, xAccessor } = moreProps;\r\n\r\n\tconst { xPos, yPos, fill, text } = helper(props, xAccessor, xScale, getYScale(chartConfig));\r\n\r\n\tconst radians = (rotate / 180) * Math.PI;\r\n\tctx.save();\r\n\tctx.translate(xPos, yPos);\r\n\tctx.rotate(radians);\r\n\r\n\tctx.font = `${ fontSize }px ${ fontFamily }`;\r\n\tctx.fillStyle = hexToRGBA(fill, opacity);\r\n\tctx.textAlign = textAnchor === \"middle\" ? \"center\" : textAnchor;\r\n\r\n\tctx.beginPath();\r\n\tctx.fillText(text, 0, 0);\r\n\tctx.restore();\r\n}\r\n\r\n\r\nexport default Label;\r\n"]}