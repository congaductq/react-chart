{"version":3,"sources":["../../../src/lib/interactive/FullLine.js"],"names":["FullLine","props","handleEnd","bind","handleDrawChannel","handleDragChannel","handleDragChannelComplete","terminate","saveNodeType","getSelectionState","nodes","state","index","newXYValue","setState","override","moreProps","trends","newTrends","map","each","idx","x","y","selected","onComplete","current","mouseXY","mouseY","yScale","chartConfig","xAccessor","currentItem","xyValue","invert","e","appearance","type","d","hoverText","tempChannel","eachAppearance","noop","getMouseCanvas","Component","propTypes","PropTypes","oneOf","isRequired","snap","bool","enabled","snapTo","func","shouldDisableSnap","onStart","onSelect","currentPositionStroke","string","currentPositionStrokeWidth","number","currentPositionOpacity","currentPositionRadius","object","array","shape","stroke","strokeOpacity","strokeWidth","fill","fillOpacity","edgeStroke","edgeFill","edgeFill2","edgeStrokeWidth","r","defaultProps","button","shiftKey","HoverTextNearMouse","enable","bgHeight","bgWidth","text"],"mappings":"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","file":"FullLine.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { isDefined, noop } from \"../utils\";\r\nimport {\r\n\tterminate,\r\n\tsaveNodeType,\r\n\tisHoverForInteractiveType,\r\n\tgetValueFromOverride,\r\n} from \"./utils\";\r\nimport EachFullLine from \"./wrapper/EachFullLine\";\r\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\r\nimport GenericChartComponent from \"../GenericChartComponent\";\r\nimport { getMouseCanvas } from \"../GenericComponent\";\r\n\r\nclass FullLine extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.handleEnd = this.handleEnd.bind(this);\r\n\t\tthis.handleDrawChannel = this.handleDrawChannel.bind(this);\r\n\t\tthis.handleDragChannel = this.handleDragChannel.bind(this);\r\n\t\tthis.handleDragChannelComplete = this.handleDragChannelComplete.bind(this);\r\n\r\n\t\tthis.terminate = terminate.bind(this);\r\n\t\tthis.saveNodeType = saveNodeType.bind(this);\r\n\r\n\t\tthis.getSelectionState = isHoverForInteractiveType(\"trends\")\r\n\t\t\t.bind(this);\r\n\r\n\t\tthis.nodes = [];\r\n\t\tthis.state = {\r\n\t\t};\r\n\t}\r\n\thandleDragChannel(index, newXYValue) {\r\n\t\tthis.setState({\r\n\t\t\toverride: {\r\n\t\t\t\tindex,\r\n\t\t\t\t...newXYValue\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\thandleDragChannelComplete(moreProps) {\r\n\t\tconst { override } = this.state;\r\n\t\tif (isDefined(override)) {\r\n\t\t\tconst { trends } = this.props;\r\n\t\t\tconst newTrends = trends\r\n\t\t\t\t.map((each, idx) => idx === override.index\r\n\t\t\t\t\t? {\r\n\t\t\t\t\t\t...each,\r\n\t\t\t\t\t\tx: override.x,\r\n\t\t\t\t\t\ty: override.y,\r\n\t\t\t\t\t\tselected: true,\r\n\t\t\t\t\t}\r\n\t\t\t\t\t: {\r\n\t\t\t\t\t\t...each,\r\n\t\t\t\t\t\tselected: false,\r\n\t\t\t\t\t});\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\toverride: null,\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onComplete(newTrends, moreProps);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleDrawChannel(moreProps) {\r\n\t\tconst { current } = this.state;\r\n\t\tif (isDefined(current)) {\r\n\t\t\tconst {\r\n\t\t\t\tmouseXY: [, mouseY],\r\n\t\t\t\tchartConfig: { yScale },\r\n\t\t\t\txAccessor,\r\n\t\t\t\tcurrentItem,\r\n\t\t\t} = moreProps;\r\n\t\t\tconst xyValue = [xAccessor(currentItem), yScale.invert(mouseY)];\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: {\r\n\t\t\t\t\tx: xyValue[0],\r\n\t\t\t\t\ty: xyValue[1],\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleEnd(moreProps, e) {\r\n\t\tconst { current } = this.state;\r\n\t\tif (isDefined(current)) {\r\n\t\t\tconst { trends, appearance, type } = this.props;\r\n\t\t\tconst {\r\n\t\t\t\tmouseXY: [, mouseY],\r\n\t\t\t\tchartConfig: { yScale },\r\n\t\t\t\txAccessor,\r\n\t\t\t\tcurrentItem,\r\n\t\t\t} = moreProps;\r\n\t\t\tconst xyValue = [xAccessor(currentItem), yScale.invert(mouseY)];\r\n\t\t\tconst newTrends = [\r\n\t\t\t\t...trends.map(d => ({ ...d, selected: false })),\r\n\t\t\t\t{\r\n\t\t\t\t\tselected: true,\r\n\t\t\t\t\tx: xyValue[0],\r\n\t\t\t\t\ty: xyValue[1],\r\n\t\t\t\t\tappearance,\r\n\t\t\t\t\ttype,\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: null,\r\n\t\t\t\ttrends: newTrends\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onComplete(newTrends, moreProps, e);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { appearance, trends, hoverText, type,\r\n\t\t} = this.props;\r\n\t\tconst { current, override } = this.state;\r\n\t\tconst tempChannel = isDefined(current) && isDefined(current.x) && isDefined(current.y)\r\n\t\t\t? <EachFullLine\r\n\t\t\t\ttype={type}\r\n\t\t\t\tinteractive={false}\r\n\t\t\t\t{...current}\r\n\t\t\t\tappearance={appearance}\r\n\t\t\t\thoverText={hoverText} />\r\n\t\t\t: null;\r\n\t\treturn <g>\r\n\t\t\t{trends.map((each, idx) => {\r\n\t\t\t\tconst eachAppearance = isDefined(each.appearance)\r\n\t\t\t\t\t? { ...appearance, ...each.appearance }\r\n\t\t\t\t\t: appearance;\r\n\t\t\t\treturn <EachFullLine key={idx}\r\n\t\t\t\t\ttype={each.type}\r\n\t\t\t\t\tref={this.saveNodeType(idx)}\r\n\t\t\t\t\tindex={idx}\r\n\t\t\t\t\tselected={each.selected}\r\n\t\t\t\t\thoverText={hoverText}\r\n\t\t\t\t\tx={getValueFromOverride(override, idx, \"x\", each.x)}\r\n\t\t\t\t\ty={getValueFromOverride(override, idx, \"y\", each.y)}\r\n\t\t\t\t\tappearance={eachAppearance}\r\n\t\t\t\t\tonDrag={this.handleDragChannel}\r\n\t\t\t\t\tonDragComplete={this.handleDragChannelComplete}\r\n\t\t\t\t/>;\r\n\t\t\t})}\r\n\t\t\t{tempChannel}\r\n\t\t\t<GenericChartComponent\r\n\t\t\t\tonClick={this.handleEnd}\r\n\t\t\t\tonMouseMove={this.handleDrawChannel}\r\n\t\t\t\tsvgDraw={noop}\r\n\t\t\t\tcanvasDraw={noop}\r\n\t\t\t\tcanvasToDraw={getMouseCanvas}\r\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\"]}\r\n\t\t\t/>;\r\n\t\t</g>;\r\n\t}\r\n}\r\n\r\n\r\nFullLine.propTypes = {\r\n\ttype: PropTypes.oneOf([\r\n\t\t\"VERTICAL\",\r\n\t\t\"HORIZONTAL\",\r\n\t]).isRequired,\r\n\tsnap: PropTypes.bool.isRequired,\r\n\tenabled: PropTypes.bool.isRequired,\r\n\tsnapTo: PropTypes.func,\r\n\tshouldDisableSnap: PropTypes.func.isRequired,\r\n\r\n\tonStart: PropTypes.func.isRequired,\r\n\tonComplete: PropTypes.func.isRequired,\r\n\tonSelect: PropTypes.func.isRequired,\r\n\r\n\tcurrentPositionStroke: PropTypes.string,\r\n\tcurrentPositionStrokeWidth: PropTypes.number,\r\n\tcurrentPositionOpacity: PropTypes.number,\r\n\tcurrentPositionRadius: PropTypes.number,\r\n\r\n\thoverText: PropTypes.object.isRequired,\r\n\ttrends: PropTypes.array.isRequired,\r\n\r\n\tappearance: PropTypes.shape({\r\n\t\tstroke: PropTypes.string.isRequired,\r\n\t\tstrokeOpacity: PropTypes.number.isRequired,\r\n\t\tstrokeWidth: PropTypes.number.isRequired,\r\n\t\tfill: PropTypes.string.isRequired,\r\n\t\tfillOpacity: PropTypes.number.isRequired,\r\n\t\tedgeStroke: PropTypes.string.isRequired,\r\n\t\tedgeFill: PropTypes.string.isRequired,\r\n\t\tedgeFill2: PropTypes.string.isRequired,\r\n\t\tedgeStrokeWidth: PropTypes.number.isRequired,\r\n\t\tr: PropTypes.number.isRequired,\r\n\t}).isRequired\r\n};\r\n\r\nFullLine.defaultProps = {\r\n\ttype: \"VERTICAL\",\r\n\tonStart: noop,\r\n\tonComplete: noop,\r\n\tonSelect: noop,\r\n\tshouldDisableSnap: e => (e.button === 2 || e.shiftKey),\r\n\r\n\tcurrentPositionStroke: \"#000000\",\r\n\tcurrentPositionOpacity: 1,\r\n\tcurrentPositionStrokeWidth: 3,\r\n\tcurrentPositionRadius: 4,\r\n\r\n\thoverText: {\r\n\t\t...HoverTextNearMouse.defaultProps,\r\n\t\tenable: true,\r\n\t\tbgHeight: 18,\r\n\t\tbgWidth: 120,\r\n\t\ttext: \"Click to select\",\r\n\t},\r\n\ttrends: [],\r\n\tappearance: {\r\n\t\tstroke: \"#000000\",\r\n\t\tstrokeOpacity: 1,\r\n\t\tstrokeWidth: 1,\r\n\t\tfill: \"#8AAFE2\",\r\n\t\tfillOpacity: 0.6,\r\n\t\tedgeStroke: \"#000000\",\r\n\t\tedgeFill: \"#FFFFFF\",\r\n\t\tedgeFill2: \"#250B98\",\r\n\t\tedgeStrokeWidth: 1,\r\n\t\tr: 5,\r\n\t}\r\n};\r\n\r\nexport default FullLine;\r\n"]}