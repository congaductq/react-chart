{"version":3,"sources":["../../../src/lib/coordinates/MouseCoordinateXV2.js"],"names":["propTypes","xPosition","PropTypes","func","drawCoordinate","displayFormat","isRequired","at","oneOf","orient","text","shape","fontStyle","string","fontWeight","fontFamily","fontSize","number","fill","oneOfType","bg","stroke","strokeWidth","padding","left","right","top","bottom","dx","dy","defaultProps","MouseCoordinateXV2","props","drawOnCanvas","bind","ctx","moreProps","show","currentItem","getXCoordinateInfo","getMouseCanvas","Component","xAccessor","xValue","xScale","height","chartConfig","font","t","textWidth","measureText","width","y","x","Math","round","textFill","textAlign","sign","halfWidth","strokeStyle","fillStyle","lineWidth","beginPath","moveTo","lineTo","closePath","textBaseline","pad","fillText"],"mappings":"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","file":"MouseCoordinateXV2.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport GenericChartComponent from \"../GenericChartComponent\";\r\nimport { getMouseCanvas } from \"../GenericComponent\";\r\n\r\n\r\nconst propTypes = {\r\n\txPosition: PropTypes.func,\r\n\tdrawCoordinate: PropTypes.func,\r\n\tdisplayFormat: PropTypes.func.isRequired,\r\n\tat: PropTypes.oneOf([\"bottom\", \"top\"]),\r\n\torient: PropTypes.oneOf([\"bottom\", \"top\"]),\r\n\ttext: PropTypes.shape({\r\n\t\tfontStyle: PropTypes.string,\r\n\t\tfontWeight: PropTypes.string,\r\n\t\tfontFamily: PropTypes.string,\r\n\t\tfontSize: PropTypes.number,\r\n\t\tfill: PropTypes.oneOfType([PropTypes.func, PropTypes.string]),\r\n\t}),\r\n\tbg: PropTypes.shape({\r\n\t\tfill: PropTypes.oneOfType([PropTypes.func, PropTypes.string]),\r\n\t\tstroke: PropTypes.string,\r\n\t\tstrokeWidth: PropTypes.number,\r\n\t\tpadding: PropTypes.shape({\r\n\t\t\tleft: PropTypes.number,\r\n\t\t\tright: PropTypes.number,\r\n\t\t\ttop: PropTypes.number,\r\n\t\t\tbottom: PropTypes.number\r\n\t\t}),\r\n\t}),\r\n\tdx: PropTypes.number,\r\n\tdy: PropTypes.number\r\n};\r\n\r\nconst defaultProps = {\r\n\txPosition,\r\n\tdrawCoordinate,\r\n\tat: \"bottom\",\r\n\torient: \"bottom\",\r\n\r\n\ttext: {\r\n\t\tfontStyle: \"\",\r\n\t\tfontWeight: \"\",\r\n\t\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\r\n\t\tfontSize: 13,\r\n\t\tfill: \"rgb(35, 35, 35)\"\r\n\t},\r\n\tbg: {\r\n\t\tfill: \"rgb(255, 255, 255)\",\r\n\t\tstroke: \"rgb(35, 35, 35)\",\r\n\t\tstrokeWidth: 1,\r\n\t\tpadding: {\r\n\t\t\tleft: 7,\r\n\t\t\tright: 7,\r\n\t\t\ttop: 4,\r\n\t\t\tbottom: 4\r\n\t\t}\r\n\t},\r\n\tdx: 7,\r\n\tdy: 7\r\n};\r\n\r\nclass MouseCoordinateXV2 extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst { show, currentItem } = moreProps;\r\n\t\tconst { drawCoordinate } = this.props;\r\n\r\n\t\tif (show && currentItem != null) {\r\n\t\t\tconst shape = getXCoordinateInfo(ctx, this.props, moreProps);\r\n\t\t\tdrawCoordinate(ctx, shape, this.props, moreProps);\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<GenericChartComponent\r\n\t\t\t\tclip={false}\r\n\t\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\t\tcanvasToDraw={getMouseCanvas}\r\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\", \"drag\"]}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMouseCoordinateXV2.defaultProps = defaultProps;\r\nMouseCoordinateXV2.propTypes = propTypes;\r\n\r\n\r\nfunction xPosition(props, moreProps) {\r\n\tconst { currentItem, xAccessor } = moreProps;\r\n\treturn xAccessor(currentItem);\r\n}\r\nfunction getXCoordinateInfo(ctx, props, moreProps) {\r\n\tconst { xPosition } = props;\r\n\tconst xValue = xPosition(props, moreProps);\r\n\tconst { at, displayFormat } = props;\r\n\tconst { text } = props;\r\n\tconst { xScale, chartConfig: { height } } = moreProps;\r\n\tctx.font = `${text.fontStyle} ${text.fontWeight} ${text.fontSize}px ${text.fontFamily}`;\r\n\r\n\tconst t = displayFormat(xValue);\r\n\tconst textWidth = ctx.measureText(t).width;\r\n\r\n\tconst y = at === \"bottom\" ? height : 0;\r\n\tconst x = Math.round(xScale(xValue));\r\n\r\n\treturn {\r\n\t\tx,\r\n\t\ty,\r\n\t\ttextWidth,\r\n\t\ttext: t\r\n\t};\r\n}\r\n\r\nfunction drawCoordinate(\r\n\tctx,\r\n\tshape,\r\n\tprops,\r\n\tmoreProps\r\n) {\r\n\tconst { x, y, textWidth, text } = shape;\r\n\tconst { orient, dx, dy } = props;\r\n\r\n\tconst {\r\n\t\tbg: { padding, fill, stroke, strokeWidth },\r\n\t\ttext: { fontSize, fill: textFill }\r\n\t} = props;\r\n\r\n\tctx.textAlign = \"center\";\r\n\r\n\tconst sign = orient === \"top\" ? -1 : 1;\r\n\tconst halfWidth = Math.round(textWidth / 2 + padding.right);\r\n\tconst height = Math.round(fontSize + padding.top + padding.bottom);\r\n\r\n\tctx.strokeStyle = typeof stroke === \"function\" ? stroke(moreProps, ctx) : stroke;\r\n\tctx.fillStyle = typeof fill === \"function\" ? fill(moreProps, ctx) : fill;\r\n\tctx.lineWidth = typeof strokeWidth === \"function\" ? strokeWidth(moreProps) : strokeWidth;\r\n\r\n\tctx.beginPath();\r\n\r\n\tctx.moveTo(x, y);\r\n\tctx.lineTo(x + dx, y + sign * dy);\r\n\tctx.lineTo(x + halfWidth, y + sign * dy);\r\n\tctx.lineTo(x + halfWidth, y + sign * (dy + height));\r\n\tctx.lineTo(x - halfWidth, y + sign * (dy + height));\r\n\tctx.lineTo(x - halfWidth, y + sign * dy);\r\n\tctx.lineTo(x - dx, y + sign * dy);\r\n\tctx.closePath();\r\n\tctx.stroke();\r\n\tctx.fill();\r\n\r\n\tctx.beginPath();\r\n\tctx.fillStyle = typeof textFill === \"function\" ? textFill(moreProps, ctx) : textFill;\r\n\r\n\tctx.textBaseline = orient === \"top\" ? \"alphabetic\" : \"hanging\";\r\n\tconst pad = orient === \"top\" ? padding.bottom : padding.top;\r\n\r\n\tctx.fillText(text, x, y + sign * (dy + pad + 2));\r\n}\r\n\r\nexport default MouseCoordinateXV2;"]}