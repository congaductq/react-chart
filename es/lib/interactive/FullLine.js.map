{"version":3,"sources":["../../../../src/lib/interactive/FullLine.js"],"names":["React","Component","PropTypes","isDefined","noop","terminate","saveNodeType","isHoverForInteractiveType","getValueFromOverride","EachFullLine","HoverTextNearMouse","GenericChartComponent","getMouseCanvas","FullLine","props","handleEnd","bind","handleDrawChannel","handleDragChannel","handleDragChannelComplete","getSelectionState","nodes","state","index","newXYValue","setState","override","moreProps","trends","newTrends","map","each","idx","x","y","selected","onComplete","current","mouseXY","mouseY","yScale","chartConfig","xAccessor","currentItem","xyValue","invert","e","appearance","type","d","hoverText","tempChannel","eachAppearance","propTypes","oneOf","isRequired","snap","bool","enabled","snapTo","func","shouldDisableSnap","onStart","onSelect","currentPositionStroke","string","currentPositionStrokeWidth","number","currentPositionOpacity","currentPositionRadius","object","array","shape","stroke","strokeOpacity","strokeWidth","fill","fillOpacity","edgeStroke","edgeFill","edgeFill2","edgeStrokeWidth","r","defaultProps","button","shiftKey","enable","bgHeight","bgWidth","text"],"mappings":"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","file":"FullLine.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { isDefined, noop } from \"../utils\";\r\nimport {\r\n\tterminate,\r\n\tsaveNodeType,\r\n\tisHoverForInteractiveType,\r\n\tgetValueFromOverride,\r\n} from \"./utils\";\r\nimport EachFullLine from \"./wrapper/EachFullLine\";\r\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\r\nimport GenericChartComponent from \"../GenericChartComponent\";\r\nimport { getMouseCanvas } from \"../GenericComponent\";\r\n\r\nclass FullLine extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.handleEnd = this.handleEnd.bind(this);\r\n\t\tthis.handleDrawChannel = this.handleDrawChannel.bind(this);\r\n\t\tthis.handleDragChannel = this.handleDragChannel.bind(this);\r\n\t\tthis.handleDragChannelComplete = this.handleDragChannelComplete.bind(this);\r\n\r\n\t\tthis.terminate = terminate.bind(this);\r\n\t\tthis.saveNodeType = saveNodeType.bind(this);\r\n\r\n\t\tthis.getSelectionState = isHoverForInteractiveType(\"trends\")\r\n\t\t\t.bind(this);\r\n\r\n\t\tthis.nodes = [];\r\n\t\tthis.state = {\r\n\t\t};\r\n\t}\r\n\thandleDragChannel(index, newXYValue) {\r\n\t\tthis.setState({\r\n\t\t\toverride: {\r\n\t\t\t\tindex,\r\n\t\t\t\t...newXYValue\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\thandleDragChannelComplete(moreProps) {\r\n\t\tconst { override } = this.state;\r\n\t\tif (isDefined(override)) {\r\n\t\t\tconst { trends } = this.props;\r\n\t\t\tconst newTrends = trends\r\n\t\t\t\t.map((each, idx) => idx === override.index\r\n\t\t\t\t\t? {\r\n\t\t\t\t\t\t...each,\r\n\t\t\t\t\t\tx: override.x,\r\n\t\t\t\t\t\ty: override.y,\r\n\t\t\t\t\t\tselected: true,\r\n\t\t\t\t\t}\r\n\t\t\t\t\t: {\r\n\t\t\t\t\t\t...each,\r\n\t\t\t\t\t\tselected: false,\r\n\t\t\t\t\t});\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\toverride: null,\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onComplete(newTrends, moreProps);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleDrawChannel(moreProps) {\r\n\t\tconst { current } = this.state;\r\n\t\tif (isDefined(current)) {\r\n\t\t\tconst {\r\n\t\t\t\tmouseXY: [, mouseY],\r\n\t\t\t\tchartConfig: { yScale },\r\n\t\t\t\txAccessor,\r\n\t\t\t\tcurrentItem,\r\n\t\t\t} = moreProps;\r\n\t\t\tconst xyValue = [xAccessor(currentItem), yScale.invert(mouseY)];\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: {\r\n\t\t\t\t\tx: xyValue[0],\r\n\t\t\t\t\ty: xyValue[1],\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleEnd(moreProps, e) {\r\n\t\tconst { current } = this.state;\r\n\t\tif (isDefined(current)) {\r\n\t\t\tconst { trends, appearance, type } = this.props;\r\n\t\t\tconst {\r\n\t\t\t\tmouseXY: [, mouseY],\r\n\t\t\t\tchartConfig: { yScale },\r\n\t\t\t\txAccessor,\r\n\t\t\t\tcurrentItem,\r\n\t\t\t} = moreProps;\r\n\t\t\tconst xyValue = [xAccessor(currentItem), yScale.invert(mouseY)];\r\n\t\t\tconst newTrends = [\r\n\t\t\t\t...trends.map(d => ({ ...d, selected: false })),\r\n\t\t\t\t{\r\n\t\t\t\t\tselected: true,\r\n\t\t\t\t\tx: xyValue[0],\r\n\t\t\t\t\ty: xyValue[1],\r\n\t\t\t\t\tappearance,\r\n\t\t\t\t\ttype,\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: null,\r\n\t\t\t\ttrends: newTrends\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onComplete(newTrends, moreProps, e);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { appearance, trends, hoverText, type,\r\n\t\t} = this.props;\r\n\t\tconst { current, override } = this.state;\r\n\t\tconst tempChannel = isDefined(current) && isDefined(current.x) && isDefined(current.y)\r\n\t\t\t? <EachFullLine\r\n\t\t\t\ttype={type}\r\n\t\t\t\tinteractive={false}\r\n\t\t\t\t{...current}\r\n\t\t\t\tappearance={appearance}\r\n\t\t\t\thoverText={hoverText} />\r\n\t\t\t: null;\r\n\t\treturn <g>\r\n\t\t\t{trends.map((each, idx) => {\r\n\t\t\t\tconst eachAppearance = isDefined(each.appearance)\r\n\t\t\t\t\t? { ...appearance, ...each.appearance }\r\n\t\t\t\t\t: appearance;\r\n\t\t\t\treturn <EachFullLine key={idx}\r\n\t\t\t\t\ttype={each.type}\r\n\t\t\t\t\tref={this.saveNodeType(idx)}\r\n\t\t\t\t\tindex={idx}\r\n\t\t\t\t\tselected={each.selected}\r\n\t\t\t\t\thoverText={hoverText}\r\n\t\t\t\t\tx={getValueFromOverride(override, idx, \"x\", each.x)}\r\n\t\t\t\t\ty={getValueFromOverride(override, idx, \"y\", each.y)}\r\n\t\t\t\t\tappearance={eachAppearance}\r\n\t\t\t\t\tonDrag={this.handleDragChannel}\r\n\t\t\t\t\tonDragComplete={this.handleDragChannelComplete}\r\n\t\t\t\t/>;\r\n\t\t\t})}\r\n\t\t\t{tempChannel}\r\n\t\t\t<GenericChartComponent\r\n\t\t\t\tonClick={this.handleEnd}\r\n\t\t\t\tonMouseMove={this.handleDrawChannel}\r\n\t\t\t\tsvgDraw={noop}\r\n\t\t\t\tcanvasDraw={noop}\r\n\t\t\t\tcanvasToDraw={getMouseCanvas}\r\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\"]}\r\n\t\t\t/>;\r\n\t\t</g>;\r\n\t}\r\n}\r\n\r\n\r\nFullLine.propTypes = {\r\n\ttype: PropTypes.oneOf([\r\n\t\t\"VERTICAL\",\r\n\t\t\"HORIZONTAL\",\r\n\t]).isRequired,\r\n\tsnap: PropTypes.bool.isRequired,\r\n\tenabled: PropTypes.bool.isRequired,\r\n\tsnapTo: PropTypes.func,\r\n\tshouldDisableSnap: PropTypes.func.isRequired,\r\n\r\n\tonStart: PropTypes.func.isRequired,\r\n\tonComplete: PropTypes.func.isRequired,\r\n\tonSelect: PropTypes.func.isRequired,\r\n\r\n\tcurrentPositionStroke: PropTypes.string,\r\n\tcurrentPositionStrokeWidth: PropTypes.number,\r\n\tcurrentPositionOpacity: PropTypes.number,\r\n\tcurrentPositionRadius: PropTypes.number,\r\n\r\n\thoverText: PropTypes.object.isRequired,\r\n\ttrends: PropTypes.array.isRequired,\r\n\r\n\tappearance: PropTypes.shape({\r\n\t\tstroke: PropTypes.string.isRequired,\r\n\t\tstrokeOpacity: PropTypes.number.isRequired,\r\n\t\tstrokeWidth: PropTypes.number.isRequired,\r\n\t\tfill: PropTypes.string.isRequired,\r\n\t\tfillOpacity: PropTypes.number.isRequired,\r\n\t\tedgeStroke: PropTypes.string.isRequired,\r\n\t\tedgeFill: PropTypes.string.isRequired,\r\n\t\tedgeFill2: PropTypes.string.isRequired,\r\n\t\tedgeStrokeWidth: PropTypes.number.isRequired,\r\n\t\tr: PropTypes.number.isRequired,\r\n\t}).isRequired\r\n};\r\n\r\nFullLine.defaultProps = {\r\n\ttype: \"VERTICAL\",\r\n\tonStart: noop,\r\n\tonComplete: noop,\r\n\tonSelect: noop,\r\n\tshouldDisableSnap: e => (e.button === 2 || e.shiftKey),\r\n\r\n\tcurrentPositionStroke: \"#000000\",\r\n\tcurrentPositionOpacity: 1,\r\n\tcurrentPositionStrokeWidth: 3,\r\n\tcurrentPositionRadius: 4,\r\n\r\n\thoverText: {\r\n\t\t...HoverTextNearMouse.defaultProps,\r\n\t\tenable: true,\r\n\t\tbgHeight: 18,\r\n\t\tbgWidth: 120,\r\n\t\ttext: \"Click to select\",\r\n\t},\r\n\ttrends: [],\r\n\tappearance: {\r\n\t\tstroke: \"#000000\",\r\n\t\tstrokeOpacity: 1,\r\n\t\tstrokeWidth: 1,\r\n\t\tfill: \"#8AAFE2\",\r\n\t\tfillOpacity: 0.6,\r\n\t\tedgeStroke: \"#000000\",\r\n\t\tedgeFill: \"#FFFFFF\",\r\n\t\tedgeFill2: \"#250B98\",\r\n\t\tedgeStrokeWidth: 1,\r\n\t\tr: 5,\r\n\t}\r\n};\r\n\r\nexport default FullLine;\r\n"]}