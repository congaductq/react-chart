{"version":3,"sources":["../../../../../src/lib/interactive/components/LinearRegressionChannelWithArea.js"],"names":["React","Component","PropTypes","sum","deviation","path","d3Path","GenericChartComponent","getMouseCanvas","isHovering2","isDefined","getClosestItemIndexes","noop","zipper","hexToRGBA","LinearRegressionChannelWithArea","props","renderSVG","bind","drawOnCanvas","isHover","moreProps","tolerance","onHover","mouseXY","helper","x1","y1","x2","y2","hovering","ctx","stroke","strokeWidth","fillOpacity","strokeOpacity","fill","dy","lineWidth","strokeStyle","fillStyle","beginPath","moveTo","lineTo","closePath","line","toString","selected","interactiveCursorClass","onUnHover","edge1Provider","edge2Provider","x1Value","x2Value","type","xScale","yScale","chartConfig","fullData","xAccessor","left","right","startIndex","Math","min","endIndex","max","array","slice","xs","map","d","valueOf","ys","close","n","length","combine","x","y","xys","xSquareds","pow","b","a","newy1","newy2","stdDev","propTypes","any","isRequired","oneOf","string","number","onDragStart","func","onDrag","onDragComplete","defaultClassName","bool","defaultProps"],"mappings":"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","file":"LinearRegressionChannelWithArea.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { sum, deviation } from \"d3-array\";\r\nimport { path as d3Path } from \"d3-path\";\r\n\r\nimport GenericChartComponent from \"../../GenericChartComponent\";\r\nimport { getMouseCanvas } from \"../../GenericComponent\";\r\nimport { isHovering2 } from \"./StraightLine\";\r\n\r\nimport { isDefined, getClosestItemIndexes, noop, zipper, hexToRGBA } from \"../../utils\";\r\n\r\nclass LinearRegressionChannelWithArea extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t\tthis.isHover = this.isHover.bind(this);\r\n\t}\r\n\tisHover(moreProps) {\r\n\t\tconst { tolerance, onHover } = this.props;\r\n\r\n\t\tif (isDefined(onHover)) {\r\n\t\t\tconst { mouseXY } = moreProps;\r\n\r\n\t\t\tconst { x1, y1, x2, y2 } = helper(this.props, moreProps);\r\n\r\n\t\t\tconst hovering = isHovering2(\r\n\t\t\t\t[x1, y1], [x2, y2], mouseXY, tolerance\r\n\t\t\t);\r\n\t\t\treturn hovering;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst { stroke, strokeWidth, fillOpacity, strokeOpacity, fill } = this.props;\r\n\t\tconst { x1, y1, x2, y2, dy } = helper(this.props, moreProps);\r\n\r\n\t\tctx.lineWidth = strokeWidth;\r\n\t\tctx.strokeStyle = hexToRGBA(stroke, strokeOpacity);\r\n\t\tctx.fillStyle = hexToRGBA(fill, fillOpacity);\r\n\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(x1, y1 - dy);\r\n\t\tctx.lineTo(x2, y2 - dy);\r\n\t\tctx.stroke();\r\n\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(x2, y2 + dy);\r\n\t\tctx.lineTo(x1, y1 + dy);\r\n\t\tctx.stroke();\r\n\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(x1, y1 - dy);\r\n\t\tctx.lineTo(x2, y2 - dy);\r\n\t\tctx.lineTo(x2, y2 + dy);\r\n\t\tctx.lineTo(x1, y1 + dy);\r\n\t\tctx.closePath();\r\n\t\tctx.fill();\r\n\r\n\t\tctx.beginPath();\r\n\t\tctx.moveTo(x2, y2);\r\n\t\tctx.lineTo(x1, y1);\r\n\t\tctx.stroke();\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { stroke, strokeWidth, fillOpacity, strokeOpacity, fill } = this.props;\r\n\t\tconst { x1, y1, x2, y2, dy } = helper(this.props, moreProps);\r\n\t\tconst line = {\r\n\t\t\tstrokeWidth,\r\n\t\t\tstroke,\r\n\t\t\tstrokeOpacity,\r\n\t\t};\r\n\t\tconst ctx = d3Path();\r\n\t\tctx.moveTo(x1, y1 - dy);\r\n\t\tctx.lineTo(x2, y2 - dy);\r\n\t\tctx.lineTo(x2, y2 + dy);\r\n\t\tctx.lineTo(x1, y1 + dy);\r\n\t\tctx.closePath();\r\n\t\treturn (\r\n\t\t\t<g>\r\n\t\t\t\t<line\r\n\t\t\t\t\t{...line}\r\n\t\t\t\t\tx1={x1}\r\n\t\t\t\t\ty1={y1 - dy}\r\n\t\t\t\t\tx2={x2}\r\n\t\t\t\t\ty2={y2 - dy}\r\n\t\t\t\t/>\r\n\t\t\t\t<line\r\n\t\t\t\t\t{...line}\r\n\t\t\t\t\tx1={x1}\r\n\t\t\t\t\ty1={y1 + dy}\r\n\t\t\t\t\tx2={x2}\r\n\t\t\t\t\ty2={y2 + dy}\r\n\t\t\t\t/>\r\n\t\t\t\t<path\r\n\t\t\t\t\td={ctx.toString()}\r\n\t\t\t\t\tfill={fill}\r\n\t\t\t\t\tfillOpacity={fillOpacity}\r\n\t\t\t\t/>\r\n\t\t\t\t<line\r\n\t\t\t\t\t{...line}\r\n\t\t\t\t\tx1={x1}\r\n\t\t\t\t\ty1={y1}\r\n\t\t\t\t\tx2={x2}\r\n\t\t\t\t\ty2={y2}\r\n\t\t\t\t/>\r\n\t\t\t</g>\r\n\t\t);\r\n\t}\r\n\trender() {\r\n\t\tconst { selected, interactiveCursorClass } = this.props;\r\n\t\tconst { onHover, onUnHover } = this.props;\r\n\r\n\t\treturn <GenericChartComponent\r\n\t\t\tisHover={this.isHover}\r\n\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\tcanvasToDraw={getMouseCanvas}\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\r\n\t\t\tinteractiveCursorClass={interactiveCursorClass}\r\n\t\t\tselected={selected}\r\n\r\n\t\t\tonHover={onHover}\r\n\t\t\tonUnHover={onUnHover}\r\n\r\n\t\t\tdrawOn={[\"mousemove\", \"mouseleave\", \"pan\", \"drag\"]}\r\n\t\t/>;\r\n\t}\r\n}\r\n\r\nexport function edge1Provider(props) {\r\n\treturn function(moreProps) {\r\n\t\tconst { x1, y1 } = helper(props, moreProps);\r\n\t\treturn [x1, y1];\r\n\t};\r\n}\r\n\r\nexport function edge2Provider(props) {\r\n\treturn function(moreProps) {\r\n\t\tconst { x2, y2 } = helper(props, moreProps);\r\n\t\treturn [x2, y2];\r\n\t};\r\n}\r\n\r\n\r\nfunction helper(props, moreProps) {\r\n\tconst { x1Value, x2Value, type } = props;\r\n\r\n\tconst { xScale, chartConfig: { yScale }, fullData } = moreProps;\r\n\tconst { xAccessor } = moreProps;\r\n\r\n\t/*\r\n\thttp://www.metastock.com/Customer/Resources/TAAZ/?p=65\r\n\ty = a + bx\r\n\tn = length of array\r\n\tb = (n * sum(x*y) - sum(xs) * sum(ys)) / (n * sum(xSquareds) - (sum(xs) ^ 2))\r\n\ta = (sum of closes)\r\n\t*/\r\n\r\n\tconst { left } = getClosestItemIndexes(fullData, x1Value, xAccessor);\r\n\tconst { right } = getClosestItemIndexes(fullData, x2Value, xAccessor);\r\n\r\n\tconst startIndex = Math.min(left, right);\r\n\tconst endIndex = Math.max(left, right) + 1;\r\n\r\n\tconst array = fullData.slice(startIndex, endIndex);\r\n\r\n\tconst xs = array.map(d => xAccessor(d).valueOf());\r\n\tconst ys = array.map(d => d.close);\r\n\tconst n = array.length;\r\n\r\n\tconst combine = zipper()\r\n\t\t.combine((x, y) => x * y);\r\n\r\n\tconst xys = combine(xs, ys);\r\n\tconst xSquareds = xs.map(x => Math.pow(x, 2));\r\n\r\n\tconst b = (n * sum(xys) - sum(xs) * sum(ys)) / (n * sum(xSquareds) - Math.pow(sum(xs), 2));\r\n\tconst a = (sum(ys) - b * sum(xs)) / n;\r\n\r\n\tconst newy1 = a + b * x1Value;\r\n\tconst newy2 = a + b * x2Value;\r\n\r\n\tconst x1 = xScale(x1Value);\r\n\tconst y1 = yScale(newy1);\r\n\tconst x2 = xScale(x2Value);\r\n\tconst y2 = yScale(newy2);\r\n\r\n\tconst stdDev = type === \"SD\"\r\n\t\t? deviation(array, d => d.close)\r\n\t\t: 0;\r\n\r\n\tconst dy = yScale(newy1 - stdDev) - y1;\r\n\r\n\treturn {\r\n\t\tx1, y1, x2, y2, dy\r\n\t};\r\n}\r\n\r\nLinearRegressionChannelWithArea.propTypes = {\r\n\tx1Value: PropTypes.any.isRequired,\r\n\tx2Value: PropTypes.any.isRequired,\r\n\r\n\ttype: PropTypes.oneOf([\r\n\t\t\"SD\", // standard deviation channel\r\n\t\t\"Raff\", // Raff Regression Channel\r\n\t]).isRequired,\r\n\r\n\tinteractiveCursorClass: PropTypes.string,\r\n\tstroke: PropTypes.string.isRequired,\r\n\tstrokeWidth: PropTypes.number.isRequired,\r\n\tfill: PropTypes.string.isRequired,\r\n\tfillOpacity: PropTypes.number.isRequired,\r\n\tstrokeOpacity: PropTypes.number.isRequired,\r\n\r\n\tonDragStart: PropTypes.func.isRequired,\r\n\tonDrag: PropTypes.func.isRequired,\r\n\tonDragComplete: PropTypes.func.isRequired,\r\n\r\n\tonHover: PropTypes.func,\r\n\tonUnHover: PropTypes.func,\r\n\r\n\tdefaultClassName: PropTypes.string,\r\n\r\n\ttolerance: PropTypes.number.isRequired,\r\n\tselected: PropTypes.bool.isRequired,\r\n};\r\n\r\nLinearRegressionChannelWithArea.defaultProps = {\r\n\tonDragStart: noop,\r\n\tonDrag: noop,\r\n\tonDragComplete: noop,\r\n\r\n\ttype: \"SD\", // standard dev\r\n\r\n\tstrokeWidth: 1,\r\n\ttolerance: 4,\r\n\tselected: false,\r\n};\r\n\r\nexport default LinearRegressionChannelWithArea;"]}